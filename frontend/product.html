<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product ‚Äî MVS Aqua</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700;800&family=Open+Sans:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="assets/css/theme.css">
  <link rel="stylesheet" href="assets/css/style.css">
  <link rel="stylesheet" href="assets/css/responsive.css">
  <style>
    .product-detail { display:grid; grid-template-columns:1fr 1fr; gap:40px; margin-bottom:60px; }
    .product-detail-img { border-radius:var(--radius); overflow:hidden; background:linear-gradient(135deg,#e0f0ff,#b3e5e5); min-height:340px; display:flex; align-items:center; justify-content:center; font-size:8rem; }
    .product-detail-body h1 { color:var(--primary); margin-bottom:8px; }
    .product-detail-price { font-size:2rem; font-weight:800; color:var(--secondary); margin:12px 0; }
    .product-detail-desc { color:#555; line-height:1.7; margin-bottom:20px; }
    @media(max-width:768px) { .product-detail { grid-template-columns:1fr; } }
  </style>
</head>
<body>

<nav class="navbar">
  <div class="navbar-inner">
    <a class="navbar-brand" href="index.html"><div class="navbar-logo">üêü</div><h1>MVS <span>Aqua</span></h1></a>
    <div class="navbar-nav">
      <a href="index.html">Home</a><a href="shop.html" class="active">Shop</a>
      <a href="about.html">About</a><a href="tracking.html">Track Order</a><a href="contact.html">Contact</a>
    </div>
    <div class="navbar-actions">
      <a href="cart.html" class="cart-icon">üõí<span class="cart-count" style="display:none">0</span></a>
      <div class="hamburger"><span></span><span></span><span></span></div>
    </div>
  </div>
</nav>

<div class="page-header">
  <div class="container">
    <h1 id="page-title">Product Detail</h1>
    <p class="breadcrumb"><a href="index.html">Home</a> / <a href="shop.html">Shop</a> / <span id="bc-name">...</span></p>
  </div>
</div>

<div class="container">
  <div id="product-container">
    <div style="text-align:center;padding:60px"><div class="loader"></div><p style="margin-top:14px;color:#666">Loading product...</p></div>
  </div>
</div>

<footer class="footer">
  <div class="container"><div class="footer-bottom"><p>¬© 2025 MVS Aqua. All rights reserved.</p></div></div>
</footer>

<script src="assets/js/api.js"></script>
<script src="assets/js/script.js"></script>
<script>
const params = new URLSearchParams(location.search);
const productId = params.get('id');

async function loadProduct() {
  const container = document.getElementById('product-container');
  try {
    let p;
    if (!productId) throw new Error('No ID');
    const data = await ProductAPI.getOne(productId);
    p = data.product || demoProduct();
    renderProduct(p);
  } catch {
    renderProduct(demoProduct());
  }
}

function demoProduct() {
  const demos = {
    1: { id:1, name:'Betta Fish', price:120, original_price:150, stock:10, category:'fish', emoji:'üêü', description:'Beautiful Betta fish, also known as Siamese fighting fish. Vibrant colors, easy to care for. Ideal for small aquariums. Our Bettas are bred in clean, healthy environments and guaranteed to be disease-free.', care:'Keep in a minimum 5L tank. Water temperature 24-28¬∞C. Feed twice daily.', shipping:'Packed in oxygen bags with insulation. Delivered within 24-48 hours.' },
    default: { id:1, name:'Aquarium Product', price:199, stock:10, category:'accessories', emoji:'üê†', description:'Premium quality product from MVS Aqua. All our products are carefully selected and quality-checked before dispatch.', care:'Follow included instructions for best results.', shipping:'Standard delivery in 2-4 business days.' }
  };
  return demos[productId] || demos.default;
}

function renderProduct(p) {
  document.getElementById('page-title').textContent = p.name;
  document.getElementById('bc-name').textContent = p.name;
  document.title = `${p.name} ‚Äî MVS Aqua`;

  const stock = p.stock > 5 ? `<span class="stock-in" style="font-size:1rem">‚úÖ In Stock (${p.stock} available)</span>` :
    p.stock > 0 ? `<span class="stock-low" style="font-size:1rem">‚ö†Ô∏è Only ${p.stock} left!</span>` :
    `<span class="stock-out" style="font-size:1rem">‚ùå Out of Stock</span>`;

  document.getElementById('product-container').innerHTML = `
    <div class="product-detail">
      <div class="product-detail-img">
        ${p.image ? `<img src="${p.image}" alt="${p.name}" style="width:100%;height:100%;object-fit:cover">` : (p.emoji || 'üêü')}
      </div>
      <div class="product-detail-body">
        <span class="badge badge-secondary mb-2">${p.category}</span>
        <h1>${p.name}</h1>
        <div>${stock}</div>
        <div class="product-detail-price">
          ‚Çπ${p.price}
          ${p.original_price ? `<span style="text-decoration:line-through;color:#999;font-size:1.2rem;font-weight:400;margin-left:10px">‚Çπ${p.original_price}</span>
          <span class="badge badge-accent" style="font-size:0.85rem;margin-left:8px">${Math.round((1-p.price/p.original_price)*100)}% OFF</span>` : ''}
        </div>
        <p class="product-detail-desc">${p.description || 'Premium quality aquarium product.'}</p>

        <div style="display:flex;align-items:center;gap:12px;margin-bottom:20px">
          <button class="qty-btn" onclick="changeDetailQty(-1)">‚àí</button>
          <span class="qty-display" id="detail-qty" style="font-size:1.2rem;min-width:40px;text-align:center">1</span>
          <button class="qty-btn" onclick="changeDetailQty(1)">+</button>
          <span style="color:#666;font-size:0.9rem">Max: ${p.stock}</span>
        </div>

        <div style="display:flex;gap:12px;flex-wrap:wrap">
          <button class="btn btn-secondary btn-lg" ${p.stock === 0 ? 'disabled' : ''} onclick="buyNow()">üõí Add to Cart</button>
          <button class="btn btn-primary btn-lg" ${p.stock === 0 ? 'disabled' : ''} onclick="buyNowWA()">üí¨ Buy via WhatsApp</button>
        </div>

        <div style="margin-top:24px;display:grid;gap:12px">
          ${p.care ? `<div class="alert alert-info">üå°Ô∏è <strong>Care Tips:</strong> ${p.care}</div>` : ''}
          ${p.shipping ? `<div class="alert alert-success">üì¶ <strong>Shipping:</strong> ${p.shipping}</div>` : ''}
        </div>
      </div>
    </div>`;

  window._currentProduct = p;
}

let qty = 1;
function changeDetailQty(delta) {
  const p = window._currentProduct;
  if (!p) return;
  qty = Math.max(1, Math.min(p.stock, qty + delta));
  document.getElementById('detail-qty').textContent = qty;
}

function buyNow() {
  const p = window._currentProduct;
  if (!p) return;
  for (let i = 0; i < qty; i++) addToCart({ id: p.id, name: p.name, price: p.price, image: p.image || '' });
  setTimeout(() => location.href = 'cart.html', 800);
}

function buyNowWA() {
  const p = window._currentProduct;
  if (!p) return;
  const msg = `Hi! I want to buy ${qty}√ó ${p.name} (‚Çπ${p.price} each) = ‚Çπ${p.price*qty} total. Please confirm availability and payment details.`;
  window.open(`https://wa.me/919876543210?text=${encodeURIComponent(msg)}`, '_blank');
}

loadProduct();
</script>
</body>
</html>
